// (c) 2018-2021 FMS_Cat - https://github.com/FMS-Cat/glcat-ts/blob/master/LICENSE
const e=16384,t=9728,r={get UnexpectedNullError(){const e=new Error("GLCat: Unexpected null detected");return e.name="UnexpectedNullError",e},get WebGL2ExclusiveError(){const e=new Error("GLCat: Attempted to use WebGL2 exclusive stuff");return e.name="WebGL2ExclusiveError",e}};class i{constructor(e,t){this.__shaders=null,this.__attribLocationCache={},this.__uniformLocationCache={},this.__uniformTextureUnitMap={},this.__uniformtextureUnitIndex=0,this.__linked=!1,this.__glCat=e,this.__program=t}get program(){return this.__program}get raw(){return this.__program}get shaders(){return this.__shaders?this.__shaders.concat():null}get isLinked(){return this.__linked}dispose(e=!1){const{gl:t}=this.__glCat;if(t.deleteProgram(this.__program),e){const e=this.shaders;e&&e.forEach((e=>{e.dispose()}))}}link(e,t={}){var i;const{gl:n}=this.__glCat;if(e.forEach((e=>n.attachShader(this.__program,e.raw))),t.transformFeedbackVaryings){if(!(WebGL2RenderingContext&&n instanceof WebGL2RenderingContext))throw r.WebGL2ExclusiveError;n.transformFeedbackVaryings(this.__program,t.transformFeedbackVaryings,null!==(i=t.transformFeedbackBufferMode)&&void 0!==i?i:n.SEPARATE_ATTRIBS)}if(n.linkProgram(this.__program),this.__linked=n.getProgramParameter(this.__program,35714),!this.__linked)throw new Error(n.getProgramInfoLog(this.__program));this.__shaders=e.concat()}linkAsync(e,t={}){var i;const n=this.__glCat,{gl:s}=this.__glCat,a=n.getExtension("KHR_parallel_shader_compile");if(e.forEach((e=>s.attachShader(this.__program,e.raw))),t.transformFeedbackVaryings){if(!(WebGL2RenderingContext&&s instanceof WebGL2RenderingContext))throw r.WebGL2ExclusiveError;s.transformFeedbackVaryings(this.__program,t.transformFeedbackVaryings,null!==(i=t.transformFeedbackBufferMode)&&void 0!==i?i:s.SEPARATE_ATTRIBS)}return s.linkProgram(this.__program),new Promise(((t,r)=>{const i=()=>{var n;if(!a||!0===s.getProgramParameter(this.__program,37297))return this.__linked=s.getProgramParameter(this.__program,35714),this.__linked?(this.__shaders=e.concat(),void t()):void r(new Error(null!==(n=s.getProgramInfoLog(this.__program))&&void 0!==n?n:"null"));requestAnimationFrame(i)};i()}))}attribute(e,t,r=1,i=0,n=5126,s=0,a=0){const{gl:o}=this.__glCat,_=this.getAttribLocation(e);-1!==_&&(null!==t?this.__glCat.bindVertexBuffer(t,(()=>{if(o.enableVertexAttribArray(_),o.vertexAttribPointer(_,r,n,!1,s,a),WebGL2RenderingContext&&o instanceof WebGL2RenderingContext)o.vertexAttribDivisor(_,i);else{const e=this.__glCat.getExtension("ANGLE_instanced_arrays");e&&e.vertexAttribDivisorANGLE(_,i)}})):o.disableVertexAttribArray(_))}uniform(e,t,...r){this["uniform"+t].call(this,e,...r)}uniformVector(e,t,r){this["uniform"+t].call(this,e,r)}uniform1i(e,t){const{gl:r}=this.__glCat,i=this.getUniformLocation(e);this.__glCat.useProgram(this,(()=>{r.uniform1i(i,t)}))}uniform2i(e,t,r){const{gl:i}=this.__glCat,n=this.getUniformLocation(e);this.__glCat.useProgram(this,(()=>{i.uniform2i(n,t,r)}))}uniform3i(e,t,r,i){const{gl:n}=this.__glCat,s=this.getUniformLocation(e);this.__glCat.useProgram(this,(()=>{n.uniform3i(s,t,r,i)}))}uniform4i(e,t,r,i,n){const{gl:s}=this.__glCat,a=this.getUniformLocation(e);this.__glCat.useProgram(this,(()=>{s.uniform4i(a,t,r,i,n)}))}uniform1iv(e,t){const{gl:r}=this.__glCat,i=this.getUniformLocation(e);this.__glCat.useProgram(this,(()=>{r.uniform1iv(i,t)}))}uniform2iv(e,t){const{gl:r}=this.__glCat,i=this.getUniformLocation(e);this.__glCat.useProgram(this,(()=>{r.uniform2iv(i,t)}))}uniform3iv(e,t){const{gl:r}=this.__glCat,i=this.getUniformLocation(e);this.__glCat.useProgram(this,(()=>{r.uniform3iv(i,t)}))}uniform4iv(e,t){const{gl:r}=this.__glCat,i=this.getUniformLocation(e);this.__glCat.useProgram(this,(()=>{r.uniform4iv(i,t)}))}uniform1f(e,t){const{gl:r}=this.__glCat,i=this.getUniformLocation(e);this.__glCat.useProgram(this,(()=>{r.uniform1f(i,t)}))}uniform2f(e,t,r){const{gl:i}=this.__glCat,n=this.getUniformLocation(e);this.__glCat.useProgram(this,(()=>{i.uniform2f(n,t,r)}))}uniform3f(e,t,r,i){const{gl:n}=this.__glCat,s=this.getUniformLocation(e);this.__glCat.useProgram(this,(()=>{n.uniform3f(s,t,r,i)}))}uniform4f(e,t,r,i,n){const{gl:s}=this.__glCat,a=this.getUniformLocation(e);this.__glCat.useProgram(this,(()=>{s.uniform4f(a,t,r,i,n)}))}uniform1fv(e,t){const{gl:r}=this.__glCat,i=this.getUniformLocation(e);this.__glCat.useProgram(this,(()=>{r.uniform1fv(i,t)}))}uniform2fv(e,t){const{gl:r}=this.__glCat,i=this.getUniformLocation(e);this.__glCat.useProgram(this,(()=>{r.uniform2fv(i,t)}))}uniform3fv(e,t){const{gl:r}=this.__glCat,i=this.getUniformLocation(e);this.__glCat.useProgram(this,(()=>{r.uniform3fv(i,t)}))}uniform4fv(e,t){const{gl:r}=this.__glCat,i=this.getUniformLocation(e);this.__glCat.useProgram(this,(()=>{r.uniform4fv(i,t)}))}uniformMatrix2fv(e,t,r=!1){const{gl:i}=this.__glCat,n=this.getUniformLocation(e);this.__glCat.useProgram(this,(()=>{i.uniformMatrix2fv(n,r,t)}))}uniformMatrix3fv(e,t,r=!1){const{gl:i}=this.__glCat,n=this.getUniformLocation(e);this.__glCat.useProgram(this,(()=>{i.uniformMatrix3fv(n,r,t)}))}uniformMatrix4fv(e,t,r=!1){const{gl:i}=this.__glCat,n=this.getUniformLocation(e);this.__glCat.useProgram(this,(()=>{i.uniformMatrix4fv(n,r,t)}))}uniformTexture(e,t){const{gl:r}=this.__glCat,i=this.getUniformLocation(e),n=this.getUniformTextureUnit(e);r.activeTexture(33984+n),this.__glCat.bindTexture2D(null!=t?t:null),this.__glCat.useProgram(this,(()=>{r.uniform1i(i,n)}))}uniformCubemap(e,t){const{gl:r}=this.__glCat,i=this.getUniformLocation(e),n=this.getUniformTextureUnit(e);r.activeTexture(33984+n),this.__glCat.bindTextureCubeMap(null!=t?t:null),this.__glCat.useProgram(this,(()=>{r.uniform1i(i,n)}))}getAttribLocation(e){const{gl:t}=this.__glCat;if(void 0!==this.__attribLocationCache[e])return this.__attribLocationCache[e];{const r=t.getAttribLocation(this.__program,e);return this.__attribLocationCache[e]=r,r}}getUniformLocation(e){const{gl:t}=this.__glCat;if(void 0!==this.__uniformLocationCache[e])return this.__uniformLocationCache[e];{const r=t.getUniformLocation(this.__program,e);return this.__uniformLocationCache[e]=r,r}}getUniformTextureUnit(e){return void 0===this.__uniformTextureUnitMap[e]&&(this.__uniformTextureUnitMap[e]=this.__uniformtextureUnitIndex,this.__uniformtextureUnitIndex++),this.__uniformTextureUnitMap[e]}}class n{constructor(e,t){this.__prev=e,this.__binder=t}bind(e,t){const r=this.__prev;if(e!==r&&(this.__binder(e),this.__prev=e),t){const i=t(e);return this.bind(r),i}}}class s{constructor(e,t){this.__glCat=e,this.__buffer=t}get buffer(){return this.__buffer}get raw(){return this.__buffer}dispose(){this.__glCat.gl.deleteBuffer(this.__buffer)}setVertexbuffer(e,t=35044){const{gl:r}=this.__glCat;this.__glCat.bindVertexBuffer(this,(()=>{r.bufferData(34962,e,t)}))}setIndexbuffer(e,t=35044){const{gl:r}=this.__glCat;this.__glCat.bindIndexBuffer(this,(()=>{r.bufferData(34963,e,t)}))}}class a{constructor(e,t){this.__renderbufferMap=new Map,this.__textureMap=new Map,this.__glCat=e,this.__framebuffer=t}get framebuffer(){return this.__framebuffer}get raw(){return this.__framebuffer}get renderbuffer(){var e;return null!==(e=this.__renderbufferMap.get(36096))&&void 0!==e?e:null}get texture(){var e;return null!==(e=this.__textureMap.get(36064))&&void 0!==e?e:null}dispose(e=!1){const{gl:t}=this.__glCat;if(t.deleteFramebuffer(this.__framebuffer),e){for(const e of this.__renderbufferMap.values())t.deleteRenderbuffer(e.raw);for(const e of this.__textureMap.values())t.deleteTexture(e.raw)}}getRenderbuffer(e=36096){var t;return null!==(t=this.__renderbufferMap.get(e))&&void 0!==t?t:null}getTexture(e=36064){var t;return null!==(t=this.__textureMap.get(e))&&void 0!==t?t:null}attachRenderbuffer(e,{attachment:t=36096}={}){const{gl:r}=this.__glCat;this.__glCat.bindFramebuffer(this,(()=>{r.framebufferRenderbuffer(36160,t,36161,e.raw)})),this.__renderbufferMap.set(t,e)}attachTexture(e,{level:t=0,attachment:r=36064}={}){const{gl:i}=this.__glCat;this.__glCat.bindFramebuffer(this,(()=>{i.framebufferTexture2D(36160,r,3553,e.raw,t)})),this.__textureMap.set(r,e)}}class o{constructor(e,t){this.__width=0,this.__height=0,this.__glCat=e,this.__renderbuffer=t}get renderbuffer(){return this.__renderbuffer}get raw(){return this.__renderbuffer}get width(){return this.__width}get height(){return this.__height}dispose(){this.__glCat.gl.deleteRenderbuffer(this.__renderbuffer)}renderbufferStorage(e,t,{format:r=this.__glCat.preferredDepthFormat}={}){const{gl:i}=this.__glCat;this.__glCat.bindRenderbuffer(this,(()=>{i.renderbufferStorage(36161,r,e,t)})),this.__width=e,this.__height=t}renderbufferStorageMultisample(e,t,{samples:i=this.__glCat.preferredMultisampleSamples,format:n=this.__glCat.preferredDepthFormat,fallbackWebGL1:s=!0}={}){const{gl:a}=this.__glCat;this.__glCat.bindRenderbuffer(this,(()=>{if(WebGL2RenderingContext&&a instanceof WebGL2RenderingContext)a.renderbufferStorageMultisample(36161,i,n,e,t);else{if(!s)throw r.WebGL2ExclusiveError;a.renderbufferStorage(36161,n,e,t)}})),this.__width=e,this.__height=t}}class _{constructor(e,t){this.__compiled=!1,this.__glCat=e,this.__shader=t}get shader(){return this.__shader}get raw(){return this.__shader}dispose(){this.__glCat.gl.deleteShader(this.__shader)}isCompiled(){return this.__compiled}compile(e){const{gl:t}=this.__glCat;if(t.shaderSource(this.__shader,e),t.compileShader(this.__shader),this.__compiled=t.getShaderParameter(this.__shader,35713),!this.__compiled)throw new Error(t.getShaderInfoLog(this.__shader))}}const l=new Uint8Array([0,0,0,0]);class h{constructor(e,t){this.__width=0,this.__height=0,this.__glCat=e,this.__texture=t,this.textureFilter(9729),this.textureWrap(33071)}get texture(){return this.__texture}get raw(){return this.__texture}get width(){return this.__width}get height(){return this.__height}dispose(){this.__glCat.gl.deleteTexture(this.__texture)}textureFilter(e=t,r=e){const{gl:i}=this.__glCat;this.__glCat.bindTexture2D(this,(()=>{i.texParameteri(3553,10240,e),i.texParameteri(3553,10241,r)}))}textureWrap(e=33071,t=e){const{gl:r}=this.__glCat;this.__glCat.bindTexture2D(this,(()=>{r.texParameteri(3553,10242,e),r.texParameteri(3553,10243,t)}))}texStorage2D(e,t,{target:i=3553,level:n=1,format:s=32856}={}){const{gl:a}=this.__glCat;if(!(WebGL2RenderingContext&&a instanceof WebGL2RenderingContext))throw r.WebGL2ExclusiveError;this.__glCat.bindTexture2D(this,(()=>{a.texStorage2D(i,n,s,e,t)}))}getParameter(e){const{gl:t}=this.__glCat;return this.__glCat.bindTexture2D(this,(()=>t.getParameter(e)))}pixelStorei(e,t){const{gl:r}=this.__glCat;this.__glCat.bindTexture2D(this,(()=>{r.pixelStorei(e,t)}))}setTexture(e){const{gl:t}=this.__glCat;this.__glCat.bindTexture2D(this,(()=>{t.texImage2D(3553,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e)})),this.__width=e.width,this.__height=e.height}setTextureFromArray(e,t,r,{internalformat:i=32856,format:n=6408,type:s=5121}={}){const{gl:a}=this.__glCat;let o=i;WebGL2RenderingContext&&a instanceof WebGL2RenderingContext?33325!==i&&33326!==i&&34842!==i&&34836!==i||(this.__glCat.getExtension("EXT_color_buffer_float",!0),this.__glCat.getExtension("EXT_float_blend"),this.__glCat.getExtension("OES_texture_float_linear")):(5131===s?(this.__glCat.getExtension("OES_texture_half_float",!0),this.__glCat.getExtension("OES_texture_half_float_linear")):5126===s&&(this.__glCat.getExtension("OES_texture_float",!0),this.__glCat.getExtension("OES_texture_float_linear")),o=n),this.__glCat.bindTexture2D(this,(()=>{a.texImage2D(3553,0,o,e,t,0,n,s,r)})),this.__width=e,this.__height=t}copyTexture(e,t){const{gl:r}=this.__glCat;this.__glCat.bindTexture2D(this,(()=>{r.copyTexImage2D(3553,0,6408,0,0,e,t,0)})),this.__width=e,this.__height=t}setCubemap(e){const{gl:t}=this.__glCat;this.__glCat.bindTextureCubeMap(this,(()=>{for(let r=0;r<6;r++)t.texImage2D(34069+r,0,6408,6408,5121,e[r]);t.texParameteri(34067,10241,9729),t.texParameteri(34067,10240,9729),t.texParameteri(34067,10242,33071),t.texParameteri(34067,10243,33071)}))}setZeroTexture(){this.setTextureFromArray(1,1,l)}}class u{constructor(e,t){this.__glCat=e,this.__transformFeedback=t}get transformFeedback(){return this.__transformFeedback}get raw(){return this.__transformFeedback}dispose(){const{gl:e}=this.__glCat;WebGL2RenderingContext&&e instanceof WebGL2RenderingContext&&e.deleteTransformFeedback(this.__transformFeedback)}bindBuffer(e,t){const{gl:r}=this.__glCat;WebGL2RenderingContext&&r instanceof WebGL2RenderingContext&&this.__glCat.bindTransformFeedback(this,(()=>{var i;r.bindBufferBase(r.TRANSFORM_FEEDBACK_BUFFER,e,null!==(i=null==t?void 0:t.buffer)&&void 0!==i?i:null)}))}}class f{constructor(e,t){this.__glCat=e,this.__vertexArray=t}get buffer(){return this.__vertexArray}get raw(){return this.__vertexArray}dispose(){const{gl:e}=this.__glCat;if(WebGL2RenderingContext&&e instanceof WebGL2RenderingContext)e.deleteVertexArray(this.__vertexArray);else{this.__glCat.getExtension("OES_vertex_array_object",!0).deleteVertexArrayOES(this.__vertexArray)}}bindVertexbuffer(e,t,r=1,i=0,n=5126,s=0,a=0){const{gl:o}=this.__glCat;this.__glCat.bindVertexArray(this,(()=>{if(o.bindBuffer(34962,e.raw),o.enableVertexAttribArray(t),o.vertexAttribPointer(t,r,n,!1,s,a),WebGL2RenderingContext&&o instanceof WebGL2RenderingContext)o.vertexAttribDivisor(t,i);else{const e=this.__glCat.getExtension("ANGLE_instanced_arrays");e&&e.vertexAttribDivisorANGLE(t,i)}}))}bindIndexbuffer(e){const{gl:t}=this.__glCat;this.__glCat.bindVertexArray(this,(()=>{t.bindBuffer(34963,e.raw)}))}}class g{constructor(e){this.preferredMultisampleSamples=4,this.__bindHelperVertexBuffer=new n(null,(e=>{var t;this.__gl.bindBuffer(34962,null!==(t=null==e?void 0:e.raw)&&void 0!==t?t:null)})),this.__bindHelperIndexBuffer=new n(null,(e=>{var t;this.__gl.bindBuffer(34963,null!==(t=null==e?void 0:e.raw)&&void 0!==t?t:null)})),this.__bindHelperTransformFeedback=new n(null,(e=>{var t;const i=this.__gl;if(!(WebGL2RenderingContext&&i instanceof WebGL2RenderingContext))throw r.WebGL2ExclusiveError;i.bindTransformFeedback(36386,null!==(t=null==e?void 0:e.raw)&&void 0!==t?t:null)})),this.__bindHelperVertexArray=new n(null,(e=>{var t;this.rawBindVertexArray(null!==(t=null==e?void 0:e.raw)&&void 0!==t?t:null)})),this.__bindHelperTexture2D=new n(null,(e=>{var t;this.__gl.bindTexture(3553,null!==(t=null==e?void 0:e.raw)&&void 0!==t?t:null)})),this.__bindHelperTextureCubeMap=new n(null,(e=>{var t;this.__gl.bindTexture(34067,null!==(t=null==e?void 0:e.raw)&&void 0!==t?t:null)})),this.__bindHelperRenderbuffer=new n(null,(e=>{var t;this.__gl.bindRenderbuffer(36161,null!==(t=null==e?void 0:e.raw)&&void 0!==t?t:null)})),this.__bindHelperFramebuffer=new n(null,(e=>{var t;this.__gl.bindFramebuffer(36160,null!==(t=null==e?void 0:e.raw)&&void 0!==t?t:null)})),this.__bindHelperProgram=new n(null,(e=>{var t;this.__gl.useProgram(null!==(t=null==e?void 0:e.raw)&&void 0!==t?t:null)})),this.__bindHelperDrawBuffers=new n([36064],(e=>{this.rawDrawBuffers(e)})),this.__extensionCache={},this.__gl=e,e.enable(2929),e.depthFunc(515),e.enable(3042),e.blendFunc(770,771),WebGL2RenderingContext&&e instanceof WebGL2RenderingContext?this.preferredDepthFormat=33190:this.preferredDepthFormat=33189}static throwIfNull(e){if(null==e)throw r.UnexpectedNullError;return e}get renderingContext(){return this.__gl}get gl(){return this.__gl}get dummyTexture(){if(this.__dummyTextureCache)return this.__dummyTextureCache;const e=this.createTexture();return e.setTextureFromArray(1,1,new Uint8Array([255,0,255,255])),this.__dummyTextureCache=e,e}getExtension(e,t){const r=this.__gl;if(this.__extensionCache[e])return this.__extensionCache[e];if(this.__extensionCache[e]=r.getExtension(e),this.__extensionCache[e])return this.__extensionCache[e];if(t)throw new Error('GLCat.getExtension: The extension "'+e+'" is not supported');return null}getExtensions(e,t){return e.map((e=>this.getExtension(e,t)))}createShader(e){const t=this.__gl,r=g.throwIfNull(t.createShader(e));return new _(this,r)}createProgram(){const e=this.__gl,t=g.throwIfNull(e.createProgram());return new i(this,t)}lazyProgram(e,t,r={}){let i;try{i=this.createShader(35633),i.compile(e);const n=this.createShader(35632);n.compile(t);const s=this.createProgram();return s.link([i,n],r),s}catch(e){throw null==i||i.dispose(),e}}lazyProgramAsync(e,t,r={}){try{const i=this.createShader(35633);i.compile(e);const n=this.createShader(35632);n.compile(t);const s=this.createProgram();return s.linkAsync([i,n],r).then((()=>s)).catch((e=>(null==s||s.dispose(),null==n||n.dispose(),null==i||i.dispose(),Promise.reject(e))))}catch(e){return Promise.reject(e)}}useProgram(e,t){return this.__bindHelperProgram.bind(e,t)}createBuffer(){const e=this.__gl,t=g.throwIfNull(e.createBuffer());return new s(this,t)}bindVertexBuffer(e,t){return this.__bindHelperVertexBuffer.bind(e,t)}bindIndexBuffer(e,t){return this.__bindHelperIndexBuffer.bind(e,t)}createTransformFeedback(){const e=this.__gl;if(WebGL2RenderingContext&&e instanceof WebGL2RenderingContext){const t=g.throwIfNull(e.createTransformFeedback());return new u(this,t)}throw r.WebGL2ExclusiveError}bindTransformFeedback(e,t){return this.__bindHelperTransformFeedback.bind(e,t)}createVertexArray(){const e=this.__gl;if(WebGL2RenderingContext&&e instanceof WebGL2RenderingContext){const t=g.throwIfNull(e.createVertexArray());return new f(this,t)}{const e=this.getExtension("OES_vertex_array_object",!0),t=g.throwIfNull(e.createVertexArrayOES());return new f(this,t)}}rawBindVertexArray(e){const t=this.__gl;if(WebGL2RenderingContext&&t instanceof WebGL2RenderingContext)t.bindVertexArray(e);else{this.getExtension("OES_vertex_array_object",!0).bindVertexArrayOES(e)}}bindVertexArray(e,t){return this.__bindHelperVertexArray.bind(e,t)}createTexture(){const e=this.__gl,t=g.throwIfNull(e.createTexture());return new h(this,t)}bindTexture2D(e,t){return this.__bindHelperTexture2D.bind(e,t)}bindTextureCubeMap(e,t){return this.__bindHelperTextureCubeMap.bind(e,t)}createRenderbuffer(){const e=this.__gl,t=g.throwIfNull(e.createRenderbuffer());return new o(this,t)}bindRenderbuffer(e,t){return this.__bindHelperRenderbuffer.bind(e,t)}createFramebuffer(){const e=this.__gl,t=g.throwIfNull(e.createFramebuffer());return new a(this,t)}bindFramebuffer(e,t){return this.__bindHelperFramebuffer.bind(e,t)}lazyFramebuffer(e,t,{isFloat:r=!1,depthFormat:i=this.preferredDepthFormat}={}){let n,s,a;try{return a=this.createFramebuffer(),s=this.createRenderbuffer(),s.renderbufferStorage(e,t,{format:i}),a.attachRenderbuffer(s,{attachment:36096}),n=this.createTexture(),r?n.setTextureFromArray(e,t,null,{internalformat:34836,format:6408,type:5126}):n.setTextureFromArray(e,t,null),a.attachTexture(n),a}catch(e){throw null==a||a.dispose(),null==n||n.dispose(),null==s||s.dispose(),e}}lazyMultisampleFramebuffer(e,t,{samples:i=4,isFloat:n=!1,depthFormat:s=this.preferredDepthFormat,fallbackWebGL1:a=!0}={}){const o=this.__gl;if(!(WebGL2RenderingContext&&o instanceof WebGL2RenderingContext)){if(a)return this.lazyFramebuffer(e,t,{isFloat:n});throw r.WebGL2ExclusiveError}{let r,a;try{a=this.createFramebuffer(),r=this.createRenderbuffer(),r.renderbufferStorageMultisample(e,t,{samples:i,format:s}),a.attachRenderbuffer(r,{attachment:36096});const o=this.createRenderbuffer(),_=n?34836:32856;return o.renderbufferStorageMultisample(e,t,{samples:i,format:_}),a.attachRenderbuffer(o,{attachment:36064}),a}catch(e){throw null==a||a.dispose(),null==r||r.dispose(),e}}}lazyDrawbuffers(e,t,r,{isFloat:i=!1,depthFormat:n=this.preferredDepthFormat}={}){if(34852<r)throw new Error("GLCat: Maximum draw buffers count exceeded");const s=[];let a;try{a=this.createFramebuffer();const s=this.createRenderbuffer();s.renderbufferStorage(e,t,{format:n}),a.attachRenderbuffer(s,{attachment:36096});for(let n=0;n<r;n++){const r=this.createTexture();i?r.setTextureFromArray(e,t,null,{internalformat:34836,format:6408,type:5126}):r.setTextureFromArray(e,t,null),a.attachTexture(r,{attachment:36064+n})}return a}catch(e){throw s.forEach((e=>{e.dispose()})),null==a||a.dispose(),e}}rawDrawBuffers(e){const t=this.__gl;if(WebGL2RenderingContext&&t instanceof WebGL2RenderingContext)t.drawBuffers(e);else{const t=this.getExtension("WEBGL_draw_buffers");null==t||t.drawBuffersWEBGL(e)}}drawBuffers(e,t){let r;if(Array.isArray(e))r=e;else if(e){r=[];for(let t=0;t<e;t++)r[t]=36064+t}else r=[36064];return this.__bindHelperDrawBuffers.bind(r,t)}drawArraysInstanced(e,t,r,i){const{gl:n}=this;if(WebGL2RenderingContext&&n instanceof WebGL2RenderingContext)n.drawArraysInstanced(e,t,r,i);else{this.getExtension("ANGLE_instanced_arrays",!0).drawArraysInstancedANGLE(e,t,r,i)}}drawElementsInstanced(e,t,r,i,n){const{gl:s}=this;if(WebGL2RenderingContext&&s instanceof WebGL2RenderingContext)s.drawElementsInstanced(e,t,r,i,n);else{this.getExtension("ANGLE_instanced_arrays",!0).drawElementsInstancedANGLE(e,t,r,i,n)}}clear(t=0,r=0,i=0,n=1,s=1){const a=this.__gl;a.clearColor(t,r,i,n),a.clearDepth(s),a.clear(256|e)}blitFramebuffer(i,n,s){var a,o,_,l,h,u,f,g,d,c,{srcViewport:m=[0,0,null!==(o=null===(a=null==i?void 0:i.renderbuffer)||void 0===a?void 0:a.width)&&void 0!==o?o:0,null!==(l=null===(_=null==i?void 0:i.renderbuffer)||void 0===_?void 0:_.height)&&void 0!==l?l:0],dstViewport:b=[0,0,null!==(u=null===(h=null==n?void 0:n.renderbuffer)||void 0===h?void 0:h.width)&&void 0!==u?u:0,null!==(g=null===(f=null==n?void 0:n.renderbuffer)||void 0===f?void 0:f.height)&&void 0!==g?g:0],mask:x=e,filter:C=t}=void 0===s?{}:s;const p=this.__gl;if(!(WebGL2RenderingContext&&p instanceof WebGL2RenderingContext))throw r.WebGL2ExclusiveError;p.bindFramebuffer(36008,null!==(d=null==i?void 0:i.raw)&&void 0!==d?d:null),p.bindFramebuffer(36009,null!==(c=null==n?void 0:n.raw)&&void 0!==c?c:null),p.blitFramebuffer(m[0],m[1],m[2],m[3],b[0],b[1],b[2],b[3],x,C),p.bindFramebuffer(36008,null),p.bindFramebuffer(36009,null)}}export default g;export{g as GLCat,s as GLCatBuffer,a as GLCatFramebuffer,i as GLCatProgram,o as GLCatRenderbuffer,_ as GLCatShader,h as GLCatTexture,u as GLCatTransformFeedback,f as GLCatVertexArray};
