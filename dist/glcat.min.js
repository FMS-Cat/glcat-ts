// (c) 2018-2020 FMS_Cat - https://github.com/FMS-Cat/glcat-ts/blob/master/LICENSE
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).GLCAT={})}(this,(function(t){"use strict";var e=34962,r=33071,i=36064,n=36096,o=34963,a=5126,u=36160,f=9729,l=35714,s=36161,_=6408,h=34836,c=32856,d=3553,g=34067,p=function(){function t(t,e){this.__prev=t,this.__binder=e}return t.prototype.bind=function(t,e){var r=this.__prev;if(t!==r&&(this.__binder(t),this.__prev=t),e){var i=e(t);return this.bind(r),i}},t}(),b=function(){function t(t,e){this.__glCat=t,this.__buffer=e}return Object.defineProperty(t.prototype,"buffer",{get:function(){return this.__buffer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"raw",{get:function(){return this.__buffer},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this.__glCat.gl.deleteBuffer(this.__buffer)},t.prototype.setVertexbuffer=function(t,r){void 0===r&&(r=35044);var i=this.__glCat.gl;this.__glCat.bindVertexBuffer(this,(function(){i.bufferData(e,t,r)}))},t.prototype.setIndexbuffer=function(t,e){void 0===e&&(e=35044);var r=this.__glCat.gl;this.__glCat.bindIndexBuffer(this,(function(){r.bufferData(o,t,e)}))},t}(),m={get UnexpectedNullError(){var t=new Error("GLCat: Unexpected null detected");return t.name="UnexpectedNullError",t},get WebGL2ExclusiveError(){var t=new Error("GLCat: Attempted to use WebGL2 exclusive stuff");return t.name="WebGL2ExclusiveError",t}};
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
function v(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function y(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,n,o=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(t){n={error:t}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return a}function x(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(y(arguments[e]));return t}var C=function(){function t(t,e){this.__renderbufferMap=new Map,this.__textureMap=new Map,this.__glCat=t,this.__framebuffer=e}return Object.defineProperty(t.prototype,"framebuffer",{get:function(){return this.__framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"raw",{get:function(){return this.__framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderbuffer",{get:function(){var t;return null!==(t=this.__renderbufferMap.get(n))&&void 0!==t?t:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"texture",{get:function(){var t;return null!==(t=this.__textureMap.get(i))&&void 0!==t?t:null},enumerable:!1,configurable:!0}),t.prototype.dispose=function(t){var e,r,i,n;void 0===t&&(t=!1);var o=this.__glCat.gl;if(o.deleteFramebuffer(this.__framebuffer),t){try{for(var a=v(this.__renderbufferMap.values()),u=a.next();!u.done;u=a.next()){var f=u.value;o.deleteRenderbuffer(f.raw)}}catch(t){e={error:t}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}try{for(var l=v(this.__textureMap.values()),s=l.next();!s.done;s=l.next()){var _=s.value;o.deleteTexture(_.raw)}}catch(t){i={error:t}}finally{try{s&&!s.done&&(n=l.return)&&n.call(l)}finally{if(i)throw i.error}}}},t.prototype.getRenderbuffer=function(t){var e;return void 0===t&&(t=n),null!==(e=this.__renderbufferMap.get(t))&&void 0!==e?e:null},t.prototype.getTexture=function(t){var e;return void 0===t&&(t=i),null!==(e=this.__textureMap.get(t))&&void 0!==e?e:null},t.prototype.attachRenderbuffer=function(t,e){var r=(void 0===e?{}:e).attachment,i=void 0===r?n:r,o=this.__glCat.gl;this.__glCat.bindFramebuffer(this,(function(){o.framebufferRenderbuffer(u,i,s,t.raw)})),this.__renderbufferMap.set(i,t)},t.prototype.attachTexture=function(t,e){var r=void 0===e?{}:e,n=r.level,o=void 0===n?0:n,a=r.attachment,f=void 0===a?i:a,l=this.__glCat.gl;this.__glCat.bindFramebuffer(this,(function(){l.framebufferTexture2D(u,f,d,t.raw,o)})),this.__textureMap.set(f,t)},t}(),w=function(){function t(t,e){this.__shaders=null,this.__attribLocationCache={},this.__uniformLocationCache={},this.__uniformTextureUnitMap={},this.__uniformtextureUnitIndex=0,this.__linked=!1,this.__glCat=t,this.__program=e}return Object.defineProperty(t.prototype,"program",{get:function(){return this.__program},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"raw",{get:function(){return this.__program},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shaders",{get:function(){return this.__shaders?this.__shaders.concat():null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLinked",{get:function(){return this.__linked},enumerable:!1,configurable:!0}),t.prototype.dispose=function(t){if(void 0===t&&(t=!1),this.__glCat.gl.deleteProgram(this.__program),t){var e=this.shaders;e&&e.forEach((function(t){t.dispose()}))}},t.prototype.link=function(){for(var t=this,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=this.__glCat.gl;if(e.forEach((function(e){return i.attachShader(t.__program,e.raw)})),i.linkProgram(this.__program),this.__linked=i.getProgramParameter(this.__program,l),!this.__linked)throw new Error(i.getProgramInfoLog(this.__program));this.__shaders=e.concat()},t.prototype.linkAsync=function(){for(var t=this,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=this.__glCat,n=this.__glCat.gl,o=i.getExtension("KHR_parallel_shader_compile");return e.forEach((function(e){return n.attachShader(t.__program,e.raw)})),n.linkProgram(this.__program),new Promise((function(r,i){var a=function(){var u;if(!o||!0===n.getProgramParameter(t.__program,37297))return t.__linked=n.getProgramParameter(t.__program,l),t.__linked?(t.__shaders=e.concat(),void r()):void i(new Error(null!==(u=n.getProgramInfoLog(t.__program))&&void 0!==u?u:"null"));requestAnimationFrame(a)};a()}))},t.prototype.attribute=function(t,e,r,i,n,o,u){var f=this;void 0===r&&(r=1),void 0===i&&(i=0),void 0===n&&(n=a),void 0===o&&(o=0),void 0===u&&(u=0);var l=this.__glCat.gl,s=this.getAttribLocation(t);-1!==s&&(null!==e?this.__glCat.bindVertexBuffer(e,(function(){if(l.enableVertexAttribArray(s),l.vertexAttribPointer(s,r,n,!1,o,u),WebGL2RenderingContext&&l instanceof WebGL2RenderingContext)l.vertexAttribDivisor(s,i);else{var t=f.__glCat.getExtension("ANGLE_instanced_arrays");t&&t.vertexAttribDivisorANGLE(s,i)}})):l.disableVertexAttribArray(s))},t.prototype.uniform=function(t,e){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var n=this["uniform"+e];n.call.apply(n,x([this,t],r))},t.prototype.uniformVector=function(t,e,r){this["uniform"+e].call(this,t,r)},t.prototype.uniform1i=function(t,e){var r=this.__glCat.gl,i=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){r.uniform1i(i,e)}))},t.prototype.uniform2i=function(t,e,r){var i=this.__glCat.gl,n=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){i.uniform2i(n,e,r)}))},t.prototype.uniform3i=function(t,e,r,i){var n=this.__glCat.gl,o=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){n.uniform3i(o,e,r,i)}))},t.prototype.uniform4i=function(t,e,r,i,n){var o=this.__glCat.gl,a=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){o.uniform4i(a,e,r,i,n)}))},t.prototype.uniform1iv=function(t,e){var r=this.__glCat.gl,i=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){r.uniform1iv(i,e)}))},t.prototype.uniform2iv=function(t,e){var r=this.__glCat.gl,i=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){r.uniform2iv(i,e)}))},t.prototype.uniform3iv=function(t,e){var r=this.__glCat.gl,i=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){r.uniform3iv(i,e)}))},t.prototype.uniform4iv=function(t,e){var r=this.__glCat.gl,i=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){r.uniform4iv(i,e)}))},t.prototype.uniform1f=function(t,e){var r=this.__glCat.gl,i=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){r.uniform1f(i,e)}))},t.prototype.uniform2f=function(t,e,r){var i=this.__glCat.gl,n=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){i.uniform2f(n,e,r)}))},t.prototype.uniform3f=function(t,e,r,i){var n=this.__glCat.gl,o=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){n.uniform3f(o,e,r,i)}))},t.prototype.uniform4f=function(t,e,r,i,n){var o=this.__glCat.gl,a=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){o.uniform4f(a,e,r,i,n)}))},t.prototype.uniform1fv=function(t,e){var r=this.__glCat.gl,i=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){r.uniform1fv(i,e)}))},t.prototype.uniform2fv=function(t,e){var r=this.__glCat.gl,i=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){r.uniform2fv(i,e)}))},t.prototype.uniform3fv=function(t,e){var r=this.__glCat.gl,i=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){r.uniform3fv(i,e)}))},t.prototype.uniform4fv=function(t,e){var r=this.__glCat.gl,i=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){r.uniform4fv(i,e)}))},t.prototype.uniformMatrix2fv=function(t,e,r){void 0===r&&(r=!1);var i=this.__glCat.gl,n=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){i.uniformMatrix2fv(n,r,e)}))},t.prototype.uniformMatrix3fv=function(t,e,r){void 0===r&&(r=!1);var i=this.__glCat.gl,n=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){i.uniformMatrix3fv(n,r,e)}))},t.prototype.uniformMatrix4fv=function(t,e,r){void 0===r&&(r=!1);var i=this.__glCat.gl,n=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){i.uniformMatrix4fv(n,r,e)}))},t.prototype.uniformTexture=function(t,e){var r=this.__glCat.gl,i=this.getUniformLocation(t),n=this.getUniformTextureUnit(t);r.activeTexture(33984+n),this.__glCat.bindTexture2D(null!=e?e:null),this.__glCat.useProgram(this,(function(){r.uniform1i(i,n)}))},t.prototype.uniformCubemap=function(t,e){var r=this.__glCat.gl,i=this.getUniformLocation(t),n=this.getUniformTextureUnit(t);r.activeTexture(33984+n),this.__glCat.bindTextureCubeMap(null!=e?e:null),this.__glCat.useProgram(this,(function(){r.uniform1i(i,n)}))},t.prototype.getAttribLocation=function(t){var e=this.__glCat.gl;if(void 0!==this.__attribLocationCache[t])return this.__attribLocationCache[t];var r=e.getAttribLocation(this.__program,t);return this.__attribLocationCache[t]=r,r},t.prototype.getUniformLocation=function(t){var e=this.__glCat.gl;if(void 0!==this.__uniformLocationCache[t])return this.__uniformLocationCache[t];var r=e.getUniformLocation(this.__program,t);return this.__uniformLocationCache[t]=r,r},t.prototype.getUniformTextureUnit=function(t){return void 0===this.__uniformTextureUnitMap[t]&&(this.__uniformTextureUnitMap[t]=this.__uniformtextureUnitIndex,this.__uniformtextureUnitIndex++),this.__uniformTextureUnitMap[t]},t}(),L=function(){function t(t,e){this.__width=0,this.__height=0,this.__glCat=t,this.__renderbuffer=e}return Object.defineProperty(t.prototype,"renderbuffer",{get:function(){return this.__renderbuffer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"raw",{get:function(){return this.__renderbuffer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.__width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.__height},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this.__glCat.gl.deleteRenderbuffer(this.__renderbuffer)},t.prototype.renderbufferStorage=function(t,e,r){var i=(void 0===r?{}:r).format,n=void 0===i?this.__glCat.preferredDepthFormat:i,o=this.__glCat.gl;this.__glCat.bindRenderbuffer(this,(function(){o.renderbufferStorage(s,n,t,e)})),this.__width=t,this.__height=e},t.prototype.renderbufferStorageMultisample=function(t,e,r){var i=void 0===r?{}:r,n=i.samples,o=void 0===n?this.__glCat.preferredMultisampleSamples:n,a=i.format,u=void 0===a?this.__glCat.preferredDepthFormat:a,f=i.fallbackWebGL1,l=void 0===f||f,_=this.__glCat.gl;this.__glCat.bindRenderbuffer(this,(function(){if(WebGL2RenderingContext&&_ instanceof WebGL2RenderingContext)_.renderbufferStorageMultisample(s,o,u,t,e);else{if(!l)throw m.WebGL2ExclusiveError;_.renderbufferStorage(s,u,t,e)}})),this.__width=t,this.__height=e},t}(),P=function(){function t(t,e){this.__compiled=!1,this.__glCat=t,this.__shader=e}return Object.defineProperty(t.prototype,"shader",{get:function(){return this.__shader},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"raw",{get:function(){return this.__shader},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this.__glCat.gl.deleteShader(this.__shader)},t.prototype.isCompiled=function(){return this.__compiled},t.prototype.compile=function(t){var e=this.__glCat.gl;if(e.shaderSource(this.__shader,t),e.compileShader(this.__shader),this.__compiled=e.getShaderParameter(this.__shader,35713),!this.__compiled)throw new Error(e.getShaderInfoLog(this.__shader))},t}(),E=new Uint8Array([0,0,0,0]),A=function(){function t(t,e){this.__width=0,this.__height=0,this.__glCat=t,this.__texture=e,this.textureFilter(f),this.textureWrap(r)}return Object.defineProperty(t.prototype,"texture",{get:function(){return this.__texture},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"raw",{get:function(){return this.__texture},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.__width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.__height},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this.__glCat.gl.deleteTexture(this.__texture)},t.prototype.textureFilter=function(t,e){void 0===t&&(t=9728),void 0===e&&(e=t);var r=this.__glCat.gl;this.__glCat.bindTexture2D(this,(function(){r.texParameteri(d,10240,t),r.texParameteri(d,10241,e)}))},t.prototype.textureWrap=function(t,e){void 0===t&&(t=r),void 0===e&&(e=t);var i=this.__glCat.gl;this.__glCat.bindTexture2D(this,(function(){i.texParameteri(d,10242,t),i.texParameteri(d,10243,e)}))},t.prototype.texStorage2D=function(t,e,r){var i=void 0===r?{}:r,n=i.target,o=void 0===n?d:n,a=i.level,u=void 0===a?1:a,f=i.format,l=void 0===f?c:f,s=this.__glCat.gl;if(!(WebGL2RenderingContext&&s instanceof WebGL2RenderingContext))throw m.WebGL2ExclusiveError;this.__glCat.bindTexture2D(this,(function(){s.texStorage2D(o,u,l,t,e)}))},t.prototype.getParameter=function(t){var e=this.__glCat.gl;return this.__glCat.bindTexture2D(this,(function(){return e.getParameter(t)}))},t.prototype.pixelStorei=function(t,e){var r=this.__glCat.gl;this.__glCat.bindTexture2D(this,(function(){r.pixelStorei(t,e)}))},t.prototype.setTexture=function(t){var e=this.__glCat.gl;this.__glCat.bindTexture2D(this,(function(){e.texImage2D(d,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t)})),this.__width=t.width,this.__height=t.height},t.prototype.setTextureFromArray=function(t,e,r,i){var n=void 0===i?{}:i,o=n.internalformat,u=void 0===o?c:o,f=n.format,l=void 0===f?_:f,s=n.type,g=void 0===s?5121:s,p=this.__glCat.gl,b=u;WebGL2RenderingContext&&p instanceof WebGL2RenderingContext?33325!==u&&33326!==u&&34842!==u&&u!==h||(this.__glCat.getExtension("EXT_color_buffer_float",!0),this.__glCat.getExtension("EXT_float_blend"),this.__glCat.getExtension("OES_texture_float_linear")):(5131===g?(this.__glCat.getExtension("OES_texture_half_float",!0),this.__glCat.getExtension("OES_texture_half_float_linear")):g===a&&(this.__glCat.getExtension("OES_texture_float",!0),this.__glCat.getExtension("OES_texture_float_linear")),b=l),this.__glCat.bindTexture2D(this,(function(){p.texImage2D(d,0,b,t,e,0,l,g,r)})),this.__width=t,this.__height=e},t.prototype.copyTexture=function(t,e){var r=this.__glCat.gl;this.__glCat.bindTexture2D(this,(function(){r.copyTexImage2D(d,0,_,0,0,t,e,0)})),this.__width=t,this.__height=e},t.prototype.setCubemap=function(t){var e=this.__glCat.gl;this.__glCat.bindTextureCubeMap(this,(function(){for(var i=0;i<6;i++)e.texImage2D(34069+i,0,_,_,5121,t[i]);e.texParameteri(g,10241,f),e.texParameteri(g,10240,f),e.texParameteri(g,10242,r),e.texParameteri(g,10243,r)}))},t.prototype.setZeroTexture=function(){this.setTextureFromArray(1,1,E)},t}(),T=function(){function t(t,e){this.__glCat=t,this.__vertexArray=e}return Object.defineProperty(t.prototype,"buffer",{get:function(){return this.__vertexArray},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"raw",{get:function(){return this.__vertexArray},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){var t=this.__glCat.gl;WebGL2RenderingContext&&t instanceof WebGL2RenderingContext?t.deleteVertexArray(this.__vertexArray):this.__glCat.getExtension("OES_vertex_array_object",!0).deleteVertexArrayOES(this.__vertexArray)},t.prototype.bindVertexbuffer=function(t,r,i,n,o,u,f){var l=this;void 0===i&&(i=1),void 0===n&&(n=0),void 0===o&&(o=a),void 0===u&&(u=0),void 0===f&&(f=0);var s=this.__glCat.gl;this.__glCat.bindVertexArray(this,(function(){if(s.bindBuffer(e,t.raw),s.enableVertexAttribArray(r),s.vertexAttribPointer(r,i,o,!1,u,f),WebGL2RenderingContext&&s instanceof WebGL2RenderingContext)s.vertexAttribDivisor(r,n);else{var a=l.__glCat.getExtension("ANGLE_instanced_arrays");a&&a.vertexAttribDivisorANGLE(r,n)}}))},t.prototype.bindIndexbuffer=function(t){var e=this.__glCat.gl;this.__glCat.bindVertexArray(this,(function(){e.bindBuffer(o,t.raw)}))},t}(),G=function(){function t(t){var r=this;this.preferredMultisampleSamples=4,this.__bindHelperVertexBuffer=new p(null,(function(t){var i;r.__gl.bindBuffer(e,null!==(i=null==t?void 0:t.raw)&&void 0!==i?i:null)})),this.__bindHelperIndexBuffer=new p(null,(function(t){var e;r.__gl.bindBuffer(o,null!==(e=null==t?void 0:t.raw)&&void 0!==e?e:null)})),this.__bindHelperVertexArray=new p(null,(function(t){var e;r.rawBindVertexArray(null!==(e=null==t?void 0:t.raw)&&void 0!==e?e:null)})),this.__bindHelperTexture2D=new p(null,(function(t){var e;r.__gl.bindTexture(d,null!==(e=null==t?void 0:t.raw)&&void 0!==e?e:null)})),this.__bindHelperTextureCubeMap=new p(null,(function(t){var e;r.__gl.bindTexture(g,null!==(e=null==t?void 0:t.raw)&&void 0!==e?e:null)})),this.__bindHelperRenderbuffer=new p(null,(function(t){var e;r.__gl.bindRenderbuffer(s,null!==(e=null==t?void 0:t.raw)&&void 0!==e?e:null)})),this.__bindHelperFramebuffer=new p(null,(function(t){var e;r.__gl.bindFramebuffer(u,null!==(e=null==t?void 0:t.raw)&&void 0!==e?e:null)})),this.__bindHelperProgram=new p(null,(function(t){var e;r.__gl.useProgram(null!==(e=null==t?void 0:t.raw)&&void 0!==e?e:null)})),this.__bindHelperDrawBuffers=new p([i],(function(t){r.rawDrawBuffers(t)})),this.__extensionCache={},this.__gl=t,t.enable(2929),t.depthFunc(515),t.enable(3042),t.blendFunc(770,771),WebGL2RenderingContext&&t instanceof WebGL2RenderingContext?this.preferredDepthFormat=33190:this.preferredDepthFormat=33189}return t.throwIfNull=function(t){if(null==t)throw m.UnexpectedNullError;return t},Object.defineProperty(t.prototype,"renderingContext",{get:function(){return this.__gl},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"gl",{get:function(){return this.__gl},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dummyTexture",{get:function(){if(this.__dummyTextureCache)return this.__dummyTextureCache;var t=this.createTexture();return t.setTextureFromArray(1,1,new Uint8Array([255,0,255,255])),this.__dummyTextureCache=t,t},enumerable:!1,configurable:!0}),t.prototype.getExtension=function(t,e){var r=this.__gl;if(this.__extensionCache[t])return this.__extensionCache[t];if(this.__extensionCache[t]=r.getExtension(t),this.__extensionCache[t])return this.__extensionCache[t];if(e)throw new Error('GLCat.getExtension: The extension "'+t+'" is not supported');return null},t.prototype.getExtensions=function(t,e){var r=this;return t.map((function(t){return r.getExtension(t,e)}))},t.prototype.createShader=function(e){var r=this.__gl,i=t.throwIfNull(r.createShader(e));return new P(this,i)},t.prototype.createProgram=function(){var e=this.__gl,r=t.throwIfNull(e.createProgram());return new w(this,r)},t.prototype.lazyProgram=function(t,e){var r;try{(r=this.createShader(35633)).compile(t);var i=this.createShader(35632);i.compile(e);var n=this.createProgram();return n.link(r,i),n}catch(t){throw null==r||r.dispose(),t}},t.prototype.lazyProgramAsync=function(t,e){try{var r=this.createShader(35633);r.compile(t);var i=this.createShader(35632);i.compile(e);var n=this.createProgram();return n.linkAsync(r,i).then((function(){return n})).catch((function(t){return null==n||n.dispose(),null==i||i.dispose(),null==r||r.dispose(),Promise.reject(t)}))}catch(t){return Promise.reject(t)}},t.prototype.useProgram=function(t,e){return this.__bindHelperProgram.bind(t,e)},t.prototype.createBuffer=function(){var e=this.__gl,r=t.throwIfNull(e.createBuffer());return new b(this,r)},t.prototype.bindVertexBuffer=function(t,e){return this.__bindHelperVertexBuffer.bind(t,e)},t.prototype.bindIndexBuffer=function(t,e){return this.__bindHelperIndexBuffer.bind(t,e)},t.prototype.createVertexArray=function(){var e=this.__gl;if(WebGL2RenderingContext&&e instanceof WebGL2RenderingContext){var r=t.throwIfNull(e.createVertexArray());return new T(this,r)}var i=this.getExtension("OES_vertex_array_object",!0);r=t.throwIfNull(i.createVertexArrayOES());return new T(this,r)},t.prototype.rawBindVertexArray=function(t){var e=this.__gl;WebGL2RenderingContext&&e instanceof WebGL2RenderingContext?e.bindVertexArray(t):this.getExtension("OES_vertex_array_object",!0).bindVertexArrayOES(t)},t.prototype.bindVertexArray=function(t,e){return this.__bindHelperVertexArray.bind(t,e)},t.prototype.createTexture=function(){var e=this.__gl,r=t.throwIfNull(e.createTexture());return new A(this,r)},t.prototype.bindTexture2D=function(t,e){return this.__bindHelperTexture2D.bind(t,e)},t.prototype.bindTextureCubeMap=function(t,e){return this.__bindHelperTextureCubeMap.bind(t,e)},t.prototype.createRenderbuffer=function(){var e=this.__gl,r=t.throwIfNull(e.createRenderbuffer());return new L(this,r)},t.prototype.bindRenderbuffer=function(t,e){return this.__bindHelperRenderbuffer.bind(t,e)},t.prototype.createFramebuffer=function(){var e=this.__gl,r=t.throwIfNull(e.createFramebuffer());return new C(this,r)},t.prototype.bindFramebuffer=function(t,e){return this.__bindHelperFramebuffer.bind(t,e)},t.prototype.lazyFramebuffer=function(t,e,r){var i,o,u,f=void 0===r?{}:r,l=f.isFloat,s=void 0!==l&&l,c=f.depthFormat,d=void 0===c?this.preferredDepthFormat:c;try{return u=this.createFramebuffer(),(o=this.createRenderbuffer()).renderbufferStorage(t,e,{format:d}),u.attachRenderbuffer(o,{attachment:n}),i=this.createTexture(),s?i.setTextureFromArray(t,e,null,{internalformat:h,format:_,type:a}):i.setTextureFromArray(t,e,null),u.attachTexture(i),u}catch(t){throw null==u||u.dispose(),null==i||i.dispose(),null==o||o.dispose(),t}},t.prototype.lazyMultisampleFramebuffer=function(t,e,r){var o=void 0===r?{}:r,a=o.samples,u=void 0===a?4:a,f=o.isFloat,l=void 0!==f&&f,s=o.depthFormat,_=void 0===s?this.preferredDepthFormat:s,d=o.fallbackWebGL1,g=void 0===d||d,p=this.__gl;if(!(WebGL2RenderingContext&&p instanceof WebGL2RenderingContext)){if(g)return this.lazyFramebuffer(t,e,{isFloat:l});throw m.WebGL2ExclusiveError}var b=void 0,v=void 0;try{v=this.createFramebuffer(),(b=this.createRenderbuffer()).renderbufferStorageMultisample(t,e,{samples:u,format:_}),v.attachRenderbuffer(b,{attachment:n});var y=this.createRenderbuffer(),x=l?h:c;return y.renderbufferStorageMultisample(t,e,{samples:u,format:x}),v.attachRenderbuffer(y,{attachment:i}),v}catch(t){throw null==v||v.dispose(),null==b||b.dispose(),t}},t.prototype.lazyDrawbuffers=function(t,e,r,o){var u=void 0===o?{}:o,f=u.isFloat,l=void 0!==f&&f,s=u.depthFormat,c=void 0===s?this.preferredDepthFormat:s;if(34852<r)throw new Error("GLCat: Maximum draw buffers count exceeded");var d;try{d=this.createFramebuffer();var g=this.createRenderbuffer();g.renderbufferStorage(t,e,{format:c}),d.attachRenderbuffer(g,{attachment:n});for(var p=0;p<r;p++){var b=this.createTexture();l?b.setTextureFromArray(t,e,null,{internalformat:h,format:_,type:a}):b.setTextureFromArray(t,e,null),d.attachTexture(b,{attachment:i+p})}return d}catch(t){throw[].forEach((function(t){t.dispose()})),null==d||d.dispose(),t}},t.prototype.rawDrawBuffers=function(t){var e=this.__gl;if(WebGL2RenderingContext&&e instanceof WebGL2RenderingContext)e.drawBuffers(t);else{var r=this.getExtension("WEBGL_draw_buffers");null==r||r.drawBuffersWEBGL(t)}},t.prototype.drawBuffers=function(t,e){var r;if(Array.isArray(t))r=t;else if(t){r=[];for(var n=0;n<t;n++)r[n]=i+n}else r=[i];return this.__bindHelperDrawBuffers.bind(r,e)},t.prototype.drawArraysInstanced=function(t,e,r,i){var n=this.gl;WebGL2RenderingContext&&n instanceof WebGL2RenderingContext?n.drawArraysInstanced(t,e,r,i):this.getExtension("ANGLE_instanced_arrays",!0).drawArraysInstancedANGLE(t,e,r,i)},t.prototype.drawElementsInstanced=function(t,e,r,i,n){var o=this.gl;WebGL2RenderingContext&&o instanceof WebGL2RenderingContext?o.drawElementsInstanced(t,e,r,i,n):this.getExtension("ANGLE_instanced_arrays",!0).drawElementsInstancedANGLE(t,e,r,i,n)},t.prototype.clear=function(t,e,r,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=1),void 0===n&&(n=1);var o=this.__gl;o.clearColor(t,e,r,i),o.clearDepth(n),o.clear(16640)},t.prototype.blitFramebuffer=function(t,e,r){var i,n,o,a,u,f,l,s,_,h,c=void 0===r?{}:r,d=c.srcViewport,g=void 0===d?[0,0,null!==(n=null===(i=null==t?void 0:t.renderbuffer)||void 0===i?void 0:i.width)&&void 0!==n?n:0,null!==(a=null===(o=null==t?void 0:t.renderbuffer)||void 0===o?void 0:o.height)&&void 0!==a?a:0]:d,p=c.dstViewport,b=void 0===p?[0,0,null!==(f=null===(u=null==e?void 0:e.renderbuffer)||void 0===u?void 0:u.width)&&void 0!==f?f:0,null!==(s=null===(l=null==e?void 0:e.renderbuffer)||void 0===l?void 0:l.height)&&void 0!==s?s:0]:p,v=c.mask,y=void 0===v?16384:v,x=c.filter,C=void 0===x?9728:x,w=this.__gl;if(!(WebGL2RenderingContext&&w instanceof WebGL2RenderingContext))throw m.WebGL2ExclusiveError;w.bindFramebuffer(36008,null!==(_=null==t?void 0:t.raw)&&void 0!==_?_:null),w.bindFramebuffer(36009,null!==(h=null==e?void 0:e.raw)&&void 0!==h?h:null),w.blitFramebuffer(g[0],g[1],g[2],g[3],b[0],b[1],b[2],b[3],y,C),w.bindFramebuffer(36008,null),w.bindFramebuffer(36009,null)},t}();t.GLCat=G,t.GLCatBuffer=b,t.GLCatFramebuffer=C,t.GLCatProgram=w,t.GLCatRenderbuffer=L,t.GLCatShader=P,t.GLCatTexture=A,t.GLCatVertexArray=T,t.default=G,Object.defineProperty(t,"__esModule",{value:!0})}));
