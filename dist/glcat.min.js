// (c) 2018-2020 FMS_Cat - https://github.com/FMS-Cat/glcat-ts/blob/master/LICENSE
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).GLCAT={})}(this,(function(t){"use strict";var e=function(){function t(t,e){this.__prev=t,this.__binder=e}return t.prototype.bind=function(t,e){var r=this.__prev;if(t!==r&&(this.__binder(t),this.__prev=t),e){var i=e(t);return this.bind(r),i}},t}(),r=function(){function t(t,e){this.__glCat=t,this.__buffer=e}return Object.defineProperty(t.prototype,"buffer",{get:function(){return this.__buffer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"raw",{get:function(){return this.__buffer},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this.__glCat.gl.deleteBuffer(this.__buffer)},t.prototype.setVertexbuffer=function(t,e){void 0===e&&(e=35044);var r=this.__glCat.gl;this.__glCat.bindVertexBuffer(this,(function(){r.bufferData(34962,t,e)}))},t.prototype.setIndexbuffer=function(t,e){void 0===e&&(e=35044);var r=this.__glCat.gl;this.__glCat.bindIndexBuffer(this,(function(){r.bufferData(34963,t,e)}))},t}(),i={get UnexpectedNullError(){var t=new Error("GLCat: Unexpected null detected");throw t.name="UnexpectedNullError",t},get WebGL2ExclusiveError(){var t=new Error("GLCat: Attempted to use WebGL2 exclusive stuff");return t.name="WebGL2ExclusiveError",t}};
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */
function n(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,n,o=r.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)a.push(i.value)}catch(t){n={error:t}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return a}function a(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t}var u=function(){function t(t,e){this.__renderbufferMap=new Map,this.__textureMap=new Map,this.__glCat=t,this.__framebuffer=e}return Object.defineProperty(t.prototype,"framebuffer",{get:function(){return this.__framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"raw",{get:function(){return this.__framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderbuffer",{get:function(){var t;return null!==(t=this.__renderbufferMap.get(36096))&&void 0!==t?t:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"texture",{get:function(){var t;return null!==(t=this.__textureMap.get(36064))&&void 0!==t?t:null},enumerable:!1,configurable:!0}),t.prototype.dispose=function(t){var e,r,i,o;void 0===t&&(t=!1);var a=this.__glCat.gl;if(a.deleteFramebuffer(this.__framebuffer),t){try{for(var u=n(this.__renderbufferMap.values()),f=u.next();!f.done;f=u.next()){var l=f.value;a.deleteRenderbuffer(l.raw)}}catch(t){e={error:t}}finally{try{f&&!f.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}try{for(var s=n(this.__textureMap.values()),_=s.next();!_.done;_=s.next()){var h=_.value;a.deleteTexture(h.raw)}}catch(t){i={error:t}}finally{try{_&&!_.done&&(o=s.return)&&o.call(s)}finally{if(i)throw i.error}}}},t.prototype.getRenderbuffer=function(t){var e;return void 0===t&&(t=36096),null!==(e=this.__renderbufferMap.get(t))&&void 0!==e?e:null},t.prototype.getTexture=function(t){var e;return void 0===t&&(t=36064),null!==(e=this.__textureMap.get(t))&&void 0!==e?e:null},t.prototype.attachRenderbuffer=function(t,e){var r=(void 0===e?{}:e).attachment,i=void 0===r?36096:r,n=this.__glCat.gl;this.__glCat.bindFramebuffer(this,(function(){n.framebufferRenderbuffer(36160,i,36161,t.raw)})),this.__renderbufferMap.set(i,t)},t.prototype.attachTexture=function(t,e){var r=void 0===e?{}:e,i=r.level,n=void 0===i?0:i,o=r.attachment,a=void 0===o?36064:o,u=this.__glCat.gl;this.__glCat.bindFramebuffer(this,(function(){u.framebufferTexture2D(36160,a,3553,t.raw,n)})),this.__textureMap.set(a,t)},t}(),f=function(){function t(t,e){this.__shaders=null,this.__attribLocationCache={},this.__uniformLocationCache={},this.__uniformTextureUnitMap={},this.__uniformtextureUnitIndex=0,this.__linked=!1,this.__glCat=t,this.__program=e}return Object.defineProperty(t.prototype,"program",{get:function(){return this.__program},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"raw",{get:function(){return this.__program},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shaders",{get:function(){return this.__shaders?this.__shaders.concat():null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isLinked",{get:function(){return this.__linked},enumerable:!1,configurable:!0}),t.prototype.dispose=function(t){if(void 0===t&&(t=!1),this.__glCat.gl.deleteProgram(this.__program),t){var e=this.shaders;e&&e.forEach((function(t){t.dispose()}))}},t.prototype.link=function(){for(var t=this,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=this.__glCat.gl;if(e.forEach((function(e){return i.attachShader(t.__program,e.raw)})),i.linkProgram(this.__program),this.__linked=i.getProgramParameter(this.__program,35714),!this.__linked)throw new Error(i.getProgramInfoLog(this.__program));this.__shaders=e.concat()},t.prototype.linkAsync=function(){for(var t=this,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var i=this.__glCat,n=this.__glCat.gl,o=i.getExtension("KHR_parallel_shader_compile");return e.forEach((function(e){return n.attachShader(t.__program,e.raw)})),n.linkProgram(this.__program),new Promise((function(r,i){var a=function(){if(!o||!0===n.getProgramParameter(t.__program,37297))return t.__linked=n.getProgramParameter(t.__program,35714),t.__linked?(t.__shaders=e.concat(),void r()):void i(n.getProgramInfoLog(t.__program));requestAnimationFrame(a)};a()}))},t.prototype.attribute=function(t,e,r,i,n,o,a){var u=this;void 0===r&&(r=1),void 0===i&&(i=0),void 0===n&&(n=5126),void 0===o&&(o=0),void 0===a&&(a=0);var f=this.__glCat.gl,l=this.getAttribLocation(t);-1!==l&&(null!==e?this.__glCat.bindVertexBuffer(e,(function(){if(f.enableVertexAttribArray(l),f.vertexAttribPointer(l,r,n,!1,o,a),f instanceof WebGL2RenderingContext)f.vertexAttribDivisor(l,i);else{var t=u.__glCat.getExtension("ANGLE_instanced_arrays");t&&t.vertexAttribDivisorANGLE(l,i)}})):f.disableVertexAttribArray(l))},t.prototype.uniform=function(t,e){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var n=this["uniform"+e];n.call.apply(n,a([this,t],r))},t.prototype.uniformVector=function(t,e,r){this["uniform"+e].call(this,t,r)},t.prototype.uniform1i=function(t,e){var r=this.__glCat.gl,i=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){r.uniform1i(i,e)}))},t.prototype.uniform2i=function(t,e,r){var i=this.__glCat.gl,n=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){i.uniform2i(n,e,r)}))},t.prototype.uniform3i=function(t,e,r,i){var n=this.__glCat.gl,o=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){n.uniform3i(o,e,r,i)}))},t.prototype.uniform4i=function(t,e,r,i,n){var o=this.__glCat.gl,a=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){o.uniform4i(a,e,r,i,n)}))},t.prototype.uniform1iv=function(t,e){var r=this.__glCat.gl,i=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){r.uniform1iv(i,e)}))},t.prototype.uniform2iv=function(t,e){var r=this.__glCat.gl,i=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){r.uniform2iv(i,e)}))},t.prototype.uniform3iv=function(t,e){var r=this.__glCat.gl,i=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){r.uniform3iv(i,e)}))},t.prototype.uniform4iv=function(t,e){var r=this.__glCat.gl,i=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){r.uniform4iv(i,e)}))},t.prototype.uniform1f=function(t,e){var r=this.__glCat.gl,i=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){r.uniform1f(i,e)}))},t.prototype.uniform2f=function(t,e,r){var i=this.__glCat.gl,n=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){i.uniform2f(n,e,r)}))},t.prototype.uniform3f=function(t,e,r,i){var n=this.__glCat.gl,o=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){n.uniform3f(o,e,r,i)}))},t.prototype.uniform4f=function(t,e,r,i,n){var o=this.__glCat.gl,a=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){o.uniform4f(a,e,r,i,n)}))},t.prototype.uniform1fv=function(t,e){var r=this.__glCat.gl,i=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){r.uniform1fv(i,e)}))},t.prototype.uniform2fv=function(t,e){var r=this.__glCat.gl,i=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){r.uniform2fv(i,e)}))},t.prototype.uniform3fv=function(t,e){var r=this.__glCat.gl,i=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){r.uniform3fv(i,e)}))},t.prototype.uniform4fv=function(t,e){var r=this.__glCat.gl,i=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){r.uniform4fv(i,e)}))},t.prototype.uniformMatrix2fv=function(t,e,r){void 0===r&&(r=!1);var i=this.__glCat.gl,n=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){i.uniformMatrix2fv(n,r,e)}))},t.prototype.uniformMatrix3fv=function(t,e,r){void 0===r&&(r=!1);var i=this.__glCat.gl,n=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){i.uniformMatrix3fv(n,r,e)}))},t.prototype.uniformMatrix4fv=function(t,e,r){void 0===r&&(r=!1);var i=this.__glCat.gl,n=this.getUniformLocation(t);this.__glCat.useProgram(this,(function(){i.uniformMatrix4fv(n,r,e)}))},t.prototype.uniformTexture=function(t,e){var r=this.__glCat.gl,i=this.getUniformLocation(t),n=this.getUniformTextureUnit(t);r.activeTexture(33984+n),this.__glCat.bindTexture2D(null!=e?e:null),this.__glCat.useProgram(this,(function(){r.uniform1i(i,n)}))},t.prototype.uniformCubemap=function(t,e){var r=this.__glCat.gl,i=this.getUniformLocation(t),n=this.getUniformTextureUnit(t);r.activeTexture(33984+n),this.__glCat.bindTextureCubeMap(null!=e?e:null),this.__glCat.useProgram(this,(function(){r.uniform1i(i,n)}))},t.prototype.getAttribLocation=function(t){var e=this.__glCat.gl;if(void 0!==this.__attribLocationCache[t])return this.__attribLocationCache[t];var r=e.getAttribLocation(this.__program,t);return this.__attribLocationCache[t]=r,r},t.prototype.getUniformLocation=function(t){var e=this.__glCat.gl;if(void 0!==this.__uniformLocationCache[t])return this.__uniformLocationCache[t];var r=e.getUniformLocation(this.__program,t);return this.__uniformLocationCache[t]=r,r},t.prototype.getUniformTextureUnit=function(t){return void 0===this.__uniformTextureUnitMap[t]&&(this.__uniformTextureUnitMap[t]=this.__uniformtextureUnitIndex,this.__uniformtextureUnitIndex++),this.__uniformTextureUnitMap[t]},t}(),l=function(){function t(t,e){this.__width=0,this.__height=0,this.__glCat=t,this.__renderbuffer=e}return Object.defineProperty(t.prototype,"renderbuffer",{get:function(){return this.__renderbuffer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"raw",{get:function(){return this.__renderbuffer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.__width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.__height},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this.__glCat.gl.deleteRenderbuffer(this.__renderbuffer)},t.prototype.init=function(t,e,r){var i=(void 0===r?{}:r).format,n=void 0===i?this.__glCat.preferredDepthFormat:i,o=this.__glCat.gl;this.__glCat.bindRenderbuffer(this,(function(){o.renderbufferStorage(36161,n,t,e)})),this.__width=t,this.__height=e},t.prototype.initMultisample=function(t,e,r){var i=void 0===r?{}:r,n=i.samples,o=void 0===n?this.__glCat.preferredMultisampleSamples:n,a=i.format,u=void 0===a?36096:a,f=this.__glCat.gl;this.__glCat.bindRenderbuffer(this,(function(){f instanceof WebGL2RenderingContext?f.renderbufferStorageMultisample(36161,o,u,t,e):f.renderbufferStorage(36161,u,t,e)})),this.__width=t,this.__height=e},t}(),s=function(){function t(t,e){this.__compiled=!1,this.__glCat=t,this.__shader=e}return Object.defineProperty(t.prototype,"shader",{get:function(){return this.__shader},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"raw",{get:function(){return this.__shader},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this.__glCat.gl.deleteShader(this.__shader)},t.prototype.isCompiled=function(){return this.__compiled},t.prototype.compile=function(t){var e=this.__glCat.gl;if(e.shaderSource(this.__shader,t),e.compileShader(this.__shader),this.__compiled=e.getShaderParameter(this.__shader,35713),!this.__compiled)throw new Error(e.getShaderInfoLog(this.__shader))},t}(),_=new Uint8Array([0,0,0,0]),h=function(){function t(t,e){this.__width=0,this.__height=0,this.__glCat=t,this.__texture=e,this.textureFilter(9729),this.textureWrap(33071)}return Object.defineProperty(t.prototype,"texture",{get:function(){return this.__texture},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"raw",{get:function(){return this.__texture},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.__width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.__height},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){this.__glCat.gl.deleteTexture(this.__texture)},t.prototype.textureFilter=function(t,e){void 0===t&&(t=9728),void 0===e&&(e=t);var r=this.__glCat.gl;this.__glCat.bindTexture2D(this,(function(){r.texParameteri(3553,10240,t),r.texParameteri(3553,10241,e)}))},t.prototype.textureWrap=function(t,e){void 0===t&&(t=33071),void 0===e&&(e=t);var r=this.__glCat.gl;this.__glCat.bindTexture2D(this,(function(){r.texParameteri(3553,10242,t),r.texParameteri(3553,10243,e)}))},t.prototype.texStorage2D=function(t,e,r){var n=void 0===r?{}:r,o=n.target,a=void 0===o?3553:o,u=n.level,f=void 0===u?1:u,l=n.format,s=void 0===l?32856:l,_=this.__glCat.gl;if(!(_ instanceof WebGL2RenderingContext))throw i.WebGL2ExclusiveError;this.__glCat.bindTexture2D(this,(function(){_.texStorage2D(a,f,s,t,e)}))},t.prototype.getParameter=function(t){var e=this.__glCat.gl;return this.__glCat.bindTexture2D(this,(function(){return e.getParameter(t)}))},t.prototype.pixelStorei=function(t,e){var r=this.__glCat.gl;this.__glCat.bindTexture2D(this,(function(){r.pixelStorei(t,e)}))},t.prototype.setTexture=function(t){var e=this.__glCat.gl;this.__glCat.bindTexture2D(this,(function(){e.texImage2D(3553,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t)})),this.__width=t.width,this.__height=t.height},t.prototype.setTextureFromArray=function(t,e,r,i){void 0===i&&(i=6408);var n=this.__glCat.gl;this.__glCat.bindTexture2D(this,(function(){n.texImage2D(3553,0,i,t,e,0,i,5121,r)})),this.__width=t,this.__height=e},t.prototype.setTextureFromFloatArray=function(t,e,r,i){var n=this;void 0===i&&(i=6408);var o=this.__glCat.gl;this.__glCat.getExtension("OES_texture_float",!0),this.__glCat.bindTexture2D(this,(function(){o.texImage2D(3553,0,i,t,e,0,i,5126,r),null===n.__glCat.getExtension("OES_texture_float_linear")&&n.textureFilter(9728)})),this.__width=t,this.__height=e},t.prototype.copyTexture=function(t,e){var r=this.__glCat.gl;this.__glCat.bindTexture2D(this,(function(){r.copyTexImage2D(3553,0,6408,0,0,t,e,0)})),this.__width=t,this.__height=e},t.prototype.setCubemap=function(t){var e=this.__glCat.gl;this.__glCat.bindTextureCubeMap(this,(function(){for(var r=0;r<6;r++)e.texImage2D(34069+r,0,6408,6408,5121,t[r]);e.texParameteri(34067,10241,9729),e.texParameteri(34067,10240,9729),e.texParameteri(34067,10242,33071),e.texParameteri(34067,10243,33071)}))},t.prototype.setZeroTexture=function(){this.setTextureFromArray(1,1,_)},t}(),c=function(){function t(t,e){this.__glCat=t,this.__vertexArray=e}return Object.defineProperty(t.prototype,"buffer",{get:function(){return this.__vertexArray},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"raw",{get:function(){return this.__vertexArray},enumerable:!1,configurable:!0}),t.prototype.dispose=function(){var t=this.__glCat.gl;t instanceof WebGL2RenderingContext?t.deleteVertexArray(this.__vertexArray):this.__glCat.getExtension("OES_vertex_array_object",!0).deleteVertexArrayOES(this.__vertexArray)},t.prototype.bindVertexbuffer=function(t,e,r,i,n,o,a){var u=this;void 0===r&&(r=1),void 0===i&&(i=0),void 0===n&&(n=5126),void 0===o&&(o=0),void 0===a&&(a=0);var f=this.__glCat.gl;this.__glCat.bindVertexArray(this,(function(){if(f.bindBuffer(34962,t.raw),f.enableVertexAttribArray(e),f.vertexAttribPointer(e,r,n,!1,o,a),f instanceof WebGL2RenderingContext)f.vertexAttribDivisor(e,i);else{var l=u.__glCat.getExtension("ANGLE_instanced_arrays");l&&l.vertexAttribDivisorANGLE(e,i)}}))},t.prototype.bindIndexbuffer=function(t){var e=this.__glCat.gl;this.__glCat.bindVertexArray(this,(function(){e.bindBuffer(34963,t.raw)}))},t}(),d=function(){function t(t){var r=this;this.preferredMultisampleSamples=4,this.__preferredDepthFormat=null,this.__bindHelperVertexBuffer=new e(null,(function(t){var e;r.__gl.bindBuffer(34962,null!==(e=null==t?void 0:t.raw)&&void 0!==e?e:null)})),this.__bindHelperIndexBuffer=new e(null,(function(t){var e;r.__gl.bindBuffer(34963,null!==(e=null==t?void 0:t.raw)&&void 0!==e?e:null)})),this.__bindHelperVertexArray=new e(null,(function(t){var e;r.rawBindVertexArray(null!==(e=null==t?void 0:t.raw)&&void 0!==e?e:null)})),this.__bindHelperTexture2D=new e(null,(function(t){var e;r.__gl.bindTexture(3553,null!==(e=null==t?void 0:t.raw)&&void 0!==e?e:null)})),this.__bindHelperTextureCubeMap=new e(null,(function(t){var e;r.__gl.bindTexture(34067,null!==(e=null==t?void 0:t.raw)&&void 0!==e?e:null)})),this.__bindHelperRenderbuffer=new e(null,(function(t){var e;r.__gl.bindRenderbuffer(36161,null!==(e=null==t?void 0:t.raw)&&void 0!==e?e:null)})),this.__bindHelperFramebuffer=new e(null,(function(t){var e;r.__gl.bindFramebuffer(36160,null!==(e=null==t?void 0:t.raw)&&void 0!==e?e:null)})),this.__bindHelperProgram=new e(null,(function(t){var e;r.__gl.useProgram(null!==(e=null==t?void 0:t.raw)&&void 0!==e?e:null)})),this.__bindHelperDrawBuffers=new e([36064],(function(t){r.rawDrawBuffers(t)})),this.__extensionCache={},this.__gl=t,t.enable(2929),t.depthFunc(515),t.enable(3042),t.blendFunc(770,771)}return t.throwIfNull=function(t){if(null==t)throw i.UnexpectedNullError;return t},Object.defineProperty(t.prototype,"preferredDepthFormat",{get:function(){return null!==this.__preferredDepthFormat?this.__preferredDepthFormat:this.__gl instanceof WebGL2RenderingContext?35056:33189},set:function(t){this.__preferredDepthFormat=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"renderingContext",{get:function(){return this.__gl},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"gl",{get:function(){return this.__gl},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dummyTexture",{get:function(){if(this.__dummyTextureCache)return this.__dummyTextureCache;var t=this.createTexture();return t.setTextureFromArray(1,1,new Uint8Array([255,0,255,255])),this.__dummyTextureCache=t,t},enumerable:!1,configurable:!0}),t.prototype.getExtension=function(t,e){var r=this.__gl;if(this.__extensionCache[t])return this.__extensionCache[t];if(this.__extensionCache[t]=r.getExtension(t),this.__extensionCache[t])return this.__extensionCache[t];if(e)throw new Error('GLCat.getExtension: The extension "'+t+'" is not supported');return null},t.prototype.getExtensions=function(t,e){var r=this;return t.map((function(t){return r.getExtension(t,e)}))},t.prototype.createShader=function(e){var r=this.__gl,i=t.throwIfNull(r.createShader(e));return new s(this,i)},t.prototype.createProgram=function(){var e=this.__gl,r=t.throwIfNull(e.createProgram());return new f(this,r)},t.prototype.lazyProgram=function(t,e){var r;try{(r=this.createShader(35633)).compile(t);var i=this.createShader(35632);i.compile(e);var n=this.createProgram();return n.link(r,i),n}catch(t){throw null==r||r.dispose(),t}},t.prototype.lazyProgramAsync=function(t,e){try{var r=this.createShader(35633);r.compile(t);var i=this.createShader(35632);i.compile(e);var n=this.createProgram();return n.linkAsync(r,i).then((function(){return n})).catch((function(t){return null==n||n.dispose(),null==i||i.dispose(),null==r||r.dispose(),Promise.reject(t)}))}catch(t){return Promise.reject(t)}},t.prototype.useProgram=function(t,e){return this.__bindHelperProgram.bind(t,e)},t.prototype.createBuffer=function(){var e=this.__gl,i=t.throwIfNull(e.createBuffer());return new r(this,i)},t.prototype.bindVertexBuffer=function(t,e){return this.__bindHelperVertexBuffer.bind(t,e)},t.prototype.bindIndexBuffer=function(t,e){return this.__bindHelperIndexBuffer.bind(t,e)},t.prototype.createVertexArray=function(){var e=this.__gl;if(e instanceof WebGL2RenderingContext){var r=t.throwIfNull(e.createVertexArray());return new c(this,r)}var i=this.getExtension("OES_vertex_array_object",!0);r=t.throwIfNull(i.createVertexArrayOES());return new c(this,r)},t.prototype.rawBindVertexArray=function(t){var e=this.__gl;e instanceof WebGL2RenderingContext?e.bindVertexArray(t):this.getExtension("OES_vertex_array_object",!0).bindVertexArrayOES(t)},t.prototype.bindVertexArray=function(t,e){return this.__bindHelperVertexArray.bind(t,e)},t.prototype.createTexture=function(){var e=this.__gl,r=t.throwIfNull(e.createTexture());return new h(this,r)},t.prototype.bindTexture2D=function(t,e){return this.__bindHelperTexture2D.bind(t,e)},t.prototype.bindTextureCubeMap=function(t,e){return this.__bindHelperTextureCubeMap.bind(t,e)},t.prototype.createRenderbuffer=function(){var e=this.__gl,r=t.throwIfNull(e.createRenderbuffer());return new l(this,r)},t.prototype.bindRenderbuffer=function(t,e){return this.__bindHelperRenderbuffer.bind(t,e)},t.prototype.createFramebuffer=function(){var e=this.__gl,r=t.throwIfNull(e.createFramebuffer());return new u(this,r)},t.prototype.bindFramebuffer=function(t,e){return this.__bindHelperFramebuffer.bind(t,e)},t.prototype.lazyFramebuffer=function(t,e,r){var i,n,o,a=void 0===r?{}:r,u=a.isFloat,f=void 0!==u&&u,l=a.depthFormat,s=void 0===l?this.preferredDepthFormat:l;try{return o=this.createFramebuffer(),(n=this.createRenderbuffer()).init(t,e,{format:s}),o.attachRenderbuffer(n,{attachment:36096}),i=this.createTexture(),f?i.setTextureFromFloatArray(t,e,null):i.setTextureFromArray(t,e,null),o.attachTexture(i),o}catch(t){throw null==o||o.dispose(),null==i||i.dispose(),null==n||n.dispose(),t}},t.prototype.lazyMultisampleFramebuffer=function(t,e,r){var n=void 0===r?{}:r,o=n.samples,a=void 0===o?4:o,u=n.isFloat,f=void 0!==u&&u,l=n.depthFormat,s=void 0===l?this.preferredDepthFormat:l,_=n.fallback,h=void 0===_||_;if(!(this.__gl instanceof WebGL2RenderingContext)){if(h)return this.lazyFramebuffer(t,e,{isFloat:f});throw i.WebGL2ExclusiveError}var c=void 0,d=void 0;try{d=this.createFramebuffer(),(c=this.createRenderbuffer()).initMultisample(t,e,{samples:a,format:s}),d.attachRenderbuffer(c,{attachment:36096});var p=this.createRenderbuffer(),g=f?34836:32856;return p.initMultisample(t,e,{samples:a,format:g}),d.attachRenderbuffer(p,{attachment:36064}),d}catch(t){throw null==d||d.dispose(),null==c||c.dispose(),t}},t.prototype.lazyDrawbuffers=function(t,e,r,i){var n=void 0===i?{}:i,o=n.isFloat,a=void 0!==o&&o,u=n.depthFormat,f=void 0===u?this.preferredDepthFormat:u;if(34852<r)throw new Error("GLCat: Maximum draw buffers count exceeded");var l;try{l=this.createFramebuffer();var s=this.createRenderbuffer();s.init(t,e,{format:f}),l.attachRenderbuffer(s,{attachment:36096});for(var _=0;_<r;_++){var h=this.createTexture();a?h.setTextureFromFloatArray(t,e,null):h.setTextureFromArray(t,e,null),l.attachTexture(h,{attachment:36064+_})}return l}catch(t){throw[].forEach((function(t){t.dispose()})),null==l||l.dispose(),t}},t.prototype.rawDrawBuffers=function(t){var e=this.__gl;if(e instanceof WebGL2RenderingContext)e.drawBuffers(t);else{var r=this.getExtension("WEBGL_draw_buffers");null==r||r.drawBuffersWEBGL(t)}},t.prototype.drawBuffers=function(t,e){var r;if(Array.isArray(t))r=t;else if(t){r=[];for(var i=0;i<t;i++)r[i]=36064+i}else r=[36064];return this.__bindHelperDrawBuffers.bind(r,e)},t.prototype.drawArraysInstanced=function(t,e,r,i){var n=this.gl;n instanceof WebGL2RenderingContext?n.drawArraysInstanced(t,e,r,i):this.getExtension("ANGLE_instanced_arrays",!0).drawArraysInstancedANGLE(t,e,r,i)},t.prototype.drawElementsInstanced=function(t,e,r,i,n){var o=this.gl;o instanceof WebGL2RenderingContext?o.drawElementsInstanced(t,e,r,i,n):this.getExtension("ANGLE_instanced_arrays",!0).drawElementsInstancedANGLE(t,e,r,i,n)},t.prototype.clear=function(t,e,r,i,n){void 0===t&&(t=0),void 0===e&&(e=0),void 0===r&&(r=0),void 0===i&&(i=1),void 0===n&&(n=1);var o=this.__gl;o.clearColor(t,e,r,i),o.clearDepth(n),o.clear(16640)},t.prototype.blitFramebuffer=function(t,e,r){var n,o,a,u,f,l,s,_,h,c,d=void 0===r?{}:r,p=d.srcViewport,g=void 0===p?[0,0,null!==(o=null===(n=null==t?void 0:t.renderbuffer)||void 0===n?void 0:n.width)&&void 0!==o?o:0,null!==(u=null===(a=null==t?void 0:t.renderbuffer)||void 0===a?void 0:a.height)&&void 0!==u?u:0]:p,m=d.dstViewport,b=void 0===m?[0,0,null!==(l=null===(f=null==e?void 0:e.renderbuffer)||void 0===f?void 0:f.width)&&void 0!==l?l:0,null!==(_=null===(s=null==e?void 0:e.renderbuffer)||void 0===s?void 0:s.height)&&void 0!==_?_:0]:m,v=d.mask,y=void 0===v?16384:v,x=d.filter,C=void 0===x?9728:x,w=this.__gl;if(!(w instanceof WebGL2RenderingContext))throw i.WebGL2ExclusiveError;w.bindFramebuffer(36008,null!==(h=null==t?void 0:t.raw)&&void 0!==h?h:null),w.bindFramebuffer(36009,null!==(c=null==e?void 0:e.raw)&&void 0!==c?c:null),w.blitFramebuffer(g[0],g[1],g[2],g[3],b[0],b[1],b[2],b[3],y,C),w.bindFramebuffer(36008,null),w.bindFramebuffer(36009,null)},t}();t.GLCat=d,t.GLCatBuffer=r,t.GLCatFramebuffer=u,t.GLCatProgram=f,t.GLCatRenderbuffer=l,t.GLCatShader=s,t.GLCatTexture=h,t.GLCatVertexArray=c,t.default=d,Object.defineProperty(t,"__esModule",{value:!0})}));
